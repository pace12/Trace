<!DOCTYPE html>

<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->

    <head>

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="css/editor.css">
        <link rel='stylesheet prefetch' href='http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css'>
      
    </head>
    <body>
    
    

        <!--[if lte IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

<style>
body{
background-color: #fff;
}

  input[type="file"] {  /* 파일 필드 숨기기 */
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip:rect(0,0,0,0);
  border: 0;
}

.w3-btn {
    border: none;
    display: inline-block;
    outline: 0;
    padding: 6px 16px;
    vertical-align: middle;
    overflow: hidden;
    text-decoration: none !important;
    color: #fff;
    background-color: #000;
    text-align: center;
    transition: .2s ease-out;
    cursor: pointer;
    white-space: nowrap;
}   

a.w3-btn:hover, a.w3-btn:active {
    background-color: #2A5577;
    color: #FFFFFF;
    box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
}

a.w3-btn, a.w3-btn:link, a.w3-btn:visited {
    color: #FFFFFF;
    background-color: #5FB6F9;
    box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
}

fieldset{
text-align: center;
margin-top: 20px;
}

p1{

font-size: 22px;
color: #5FB6F9;
}

p1:hover{
color: #2A5577;
}

.tracearea {
    box-shadow: 0 2px 4px 0 rgba(0,0,0,0.16),0 2px 10px 0 rgba(0,0,0,0.12) !important;
    background-color: #f1f1f1;
    padding: 0.01em 16px;
}

        
</style>
<!--////////////////////////////////////////////////////////////내비게이션바///////////////////////////////////////////////////////////-->
<!--////////////////////////////////////////////////////////////내비게이션바///////////////////////////////////////////////////////////-->
        
        <header role="banner">
            <nav role="navigation" class="navbar navbar-default">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                  </button>
                  <a class="navbar-brand" href="index.html"><img src="img/logo.png" alt="Bootstrappin'" width="120"></a>
                </div>
                <div class="navbar-collapse collapse">
                  <ul class="nav navbar-nav">
                    <li><a href="index.html">
                        <span class="fa fa-home"></span> Home
                    </a></li>
                       <li class="active"><a href="write.html">
                        <span class="fa fa-pencil-square-o"></span> Write
                    </a></li>
                    <li><a href="gallery.html">
                        <span class="fa fa-picture-o"></span> Gallery
                    </a></li>
                    <li><a href="#">
                        <span class="fa fa-envelope"></span> Contact
                    </a></li>
                  </ul>
                    <ul class="nav navbar-nav navbar-right" clear="both">

        <li><a href="#"><span class="fa fa-sign-in"></span> Register</a></li>
          <li><a href="#" id="myBtn"><span class="fa fa-power-off"></span> Login</a></li>
                </div><!--/.nav-collapse -->
              </div><!--/.container -->
            </nav>
        </header>
            
            
<!--////////////////////////////////////////////////////////////텍스트에디터///////////////////////////////////////////////////////////-->
<!--////////////////////////////////////////////////////////////텍스트에디터///////////////////////////////////////////////////////////-->            
            
            <main role="main">
                
 
          <center>
          <div class=tracearea>
                <div class="images"></div>
               <div class="form-group  has-feedback">
                        <textarea name="content.text" id="texteditor" rows="20"
                           class="form-control input-block-level"></textarea>
                    </div>
            </div>
            </center>
            
            <form method="post" enctype="multipart/form-data"> 
               <fieldset class="buttons" id="buttons">
                  <a href="/articles/community" class="btn-default"
                     onclick="return confirm(&#39;정말로 취소하시겠습니까?&#39;)">
                        <!-- <button type="button" class="btn btn-primary pull-left">취소</button> -->
                        <a target="_blank" class="w3-btn">취소</a>
                  </a>
                  &nbsp&nbsp&nbsp&nbsp&nbsp
                        <p1><label for="fileupload" class="fa fa-camera-retro"></label></a>
                        <input name ="files" class="imagesname" type="file" id="fileupload" multiple> 
                     </p1>&nbsp&nbsp&nbsp&nbsp&nbsp
                     
                        <p1><i class="fa fa-map-marker"></i></a></p1>&nbsp&nbsp&nbsp&nbsp&nbsp
                        <!-- <button type="button" class="btn btn-primary pull-right" id="create">등록</button> -->
                        <a target="_blank" class="w3-btn" id="create">등록</a>
            </fieldset>
         </form>
    
                
          </center>
                
            </main>
            
            

        <footer role="contentinfo">

            <p><a href="index.html"><img src="img/logo.png" width="80" alt="Bootstrappin&#39;"></a></p>

            <ul class="social">
              <li><a href="#" title="Twitter Profile"><span class="icon fa fa-twitter"></span></a></li>
              <li><a href="#" title="Facebook Page"><span class="icon fa fa-facebook"></span></a></li>
              <li><a href="#" title="LinkedIn Profile"><span class="icon fa fa-linkedin"></span></a></li>
              <li><a href="#" title="Google+ Profile"><span class="icon fa fa-google-plus"></span></a></li>
              <li><a href="#" title="GitHub Profile"><span class="icon fa fa-github-alt"></span></a></li>
            </ul>

        </footer>
        

<!--////////////////////////////////////////////////////////////자바스크립트///////////////////////////////////////////////////////////-->
<!--////////////////////////////////////////////////////////////자바스크립트///////////////////////////////////////////////////////////-->

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
        <script src="js/plugins.js"></script>

        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
      	<script src="js/vendor/modernizr-2.6.2.min.js"></script>

        <script src="js/vendor/jquery.ui.widget.js"></script>      
      	<script src="js/jquery.fileupload.js"></script>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>

<!--에디터자바스크립트-->            


       
    <script type="text/javascript">
   
    var addMemberSucess = false;
	var filesList = [];
	var traceNumber = 0;
    
     $(function(){
          $("#fileupload").change(function () {
              if (typeof (FileReader) != "undefined") {
                  var dvPreview = $(".images");
                  dvPreview.html("");
                  var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.jpg|.jpeg|.gif|.png|.bmp)$/;
                  $($(this)[0].files).each(function () {
                      var file = $(this);
                      if (regex.test(file[0].name.toLowerCase())) {
                          var reader = new FileReader();
                          reader.onload = function (e) {
                              var img = $("<img />");
                              img.attr("name",file[0].name);
                              img.attr("id","multi");
                              img.attr("style", "width:250px; height:200px; margin-right: 10px;margin-top: 10px;");
                              img.attr("src", e.target.result);
                              
                              dvPreview.append(img);
                            
                          }
                          reader.readAsDataURL(file[0]);
                      } else {
                          alert(file[0].name + " is not a valid image file.");
                          dvPreview.html("");
                          return false;
                      }
                  });
              } else {
                  alert("This browser does not support HTML5 FileReader.");
              }
          });
       }); 
    
/*        $(function(){
           $(".w3-btn").on("click" , function() {
              fncAddJsonTrace();
            fncFileUploadTrace(); 
          });
       
       });
       
<<<<<<< HEAD
       function  fncAddJsonTrace(){
          
           var iiii = $("div.images > img").length;
           alert(iiii);
         
          
          var aananan = "";
         for(var i=0 ; i<$("div.images > img").length ; i++){
         for each ($("div.images > img:last").length in obj) 
         if(i == ($("div.images > img").length - 1)){
            aananan +=$("div.images > img:eq("+i+")").attr('name');
         }else{
            aananan += $("div.images > img:eq("+i+")").attr('name') +",";
         }
          } 
          alert(aananan);
          
          var aananan = $("div.images > img:eq(0)").attr('name');
          alert(aananan); 
       
             $.ajax({
                type:"POST",
                async:false,
                headers : {
                   "Accept" : "application/json",
                   "Content-Type" : "application/json"
                },
                data: JSON.stringify({
                   oriImgName : aananan,
                   text : $("#texteditor").val()
                }),
                url:"/trace/jsonAddTrace",
                dataType:"json",
                success:function(data, status){
                	location.href = "gallery.html";
                }
             });
          } */
       
=======
		function  fncAddJsonTrace(){
		   
		  var imgLength = $("div.images > img").length;
		  var imgNames = "";
		  
		  for(var i=0 ; i<imgLength ; i++){
		  	if(i == ($("div.images > img").length - 1)){
			  imgNames +=$("div.images > img:eq("+i+")").attr('name');
		  	}else{
			  imgNames += $("div.images > img:eq("+i+")").attr('name') +",";
		  	}
		  }
		  
	      $.ajax({
	         type:"POST",
	         async:false,
	         headers : {
	            "Accept" : "application/json",
	            "Content-Type" : "application/json"
	         },
	         data: JSON.stringify({
	            oriImgName : imgNames,
	            text : $("#texteditor").val()
	         }),
	         url:"/trace/jsonAddTrace",
	         dataType:"json",
	         success:function(data, status){
	        	console.log(data);
	        	if(data.traceNo != null || data.traceNo > 0){ 
		        	addMemberSucess = true;
		        	traceNumber = data.traceNo;
		        	console.log(traceNumber);
		         	location.href = "gallery.html";
					
	        	}else{
	        		addMemberSucess = false;
	        	}
	         }
	      });
>>>>>>> branch 'master' of https://github.com/wldudyl707/Trace.git

<<<<<<< HEAD
          
$(function() { 
			$('#fileupload').fileupload({
				autoUpload: false,
				singleFileUploads: false,
				multipart: true,
				url: '/trace/upload',
				dataType:'json'
			}).on('fileuploadadd', function(e, data){
				$.each(data.files, function(index, file){
					filesList.push(data.files[index]);
					console.log("Added : " + data.files[index].name);
				});
			});
			
			$('#create').on('click', function(event){
				if(filesList.length > 0){
					console.log("multi file submit");
					event.preventDefault();
					$('#fileupload').fileupload('send', {files: filesList, formData: {traceNo : traceNumber}})
						.error(function(jqXHR, textStatus, errorThrown){console.log('error');})
						.complete(function(result, textStatus, jqXHR){
							addTrace();
						});
				}else{
					console.log("plain default form submit");
				}
			});
  		});
	
function addTrace(){
	var aananan = $("div.images > img:eq(0)").attr('name');
    alert(aananan);
    
	$.ajax({
        type:"POST",
        async:false,
        headers : {
           "Accept" : "application/json",
           "Content-Type" : "application/json"
        },
        data: JSON.stringify({
           oriImgName : aananan,
           text : $("#texteditor").val()
        }),
        url:"/trace/jsonAddTrace",
        dataType:"json",
        success:function(data, status){
        	location.href = "gallery.html";
        	//alert('yes');
        }
     });
}
=======
		}
       
  		$(function() { 
			$('#fileupload').fileupload({
				autoUpload: false,
				singleFileUploads: false,
				multipart: true,
				url: '/trace/upload',
				dataType:'json'
			}).on('fileuploadadd', function(e, data){
				$.each(data.files, function(index, file){
					filesList.push(data.files[index]);
					console.log("Added : " + data.files[index].name);
				});
			});
			
			$('#create').on('click', function(event){
				if(filesList.length > 0){
					console.log("multi file submit");
					event.preventDefault();
					$('#fileupload').fileupload('send', {files: filesList, formData: {traceNo : traceNumber}})
						.success(function(result, textStatus, jqXHR){console.log('success');})
						.error(function(jqXHR, textStatus, errorThrown){console.log('error');})
						.complete(function(result, textStatus, jqXHR){
							console.log('complete: ' + JSON.stringify(result));
						});
				}else{
					console.log("plain default form submit");
				}
			});
  		});

		
>>>>>>> branch 'master' of https://github.com/wldudyl707/Trace.git
    
    </script>    
    </body>
</html>